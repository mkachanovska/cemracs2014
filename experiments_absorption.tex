\documentclass[a4paper,10pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath,amsfonts,amssymb,amsthm,epsfig,epstopdf,array}


\begin{document}
We consider the set of Maxwell equations with a linear current in two dimensions \cite{stable_yee_plasma_current}
 with absorption terms
\begin{align*}
\epsilon_0\partial_t E_{x}-\partial_y H=-eN_e u_x,\\
\epsilon_0\partial_t E_{y}+\partial_x H=-eN_e u_y,\\
\mu_0\partial_t H+\partial_x E_y-\partial_y E_x=0,\\
m_e\partial_t u_x=eE_x+eu_yB_0-\nu m_e u_x,\\
m_e\partial_t u_y=eE_y-eu_xB_0-\nu m_e u_y
\end{align*}
posed in $[-L,\; \mathbb{R}]\times \mathbb{R}$. The boundary conditions 
\begin{align*}
 H|_{-L}=g(t).
\end{align*}

After performing the Fourier transform in $y$ ($\partial_y\rightarrow i\theta $), and setting the 
corresponding Fourier variable $\theta$ to $0$, we obtain
\begin{align*}
 \epsilon_0 \partial_t E_x=-eN_e u_x,\\
 \epsilon_0\partial_t E_y+\partial_x H=-e N_e u_y,\\
 \mu_0\partial_t H+\partial_x E_y=0,\\
m_e\partial_t u_x=eE_x+eu_yB_0-\nu m_e u_x,\\
m_e\partial_t u_y=eE_y-eu_xB_0-\nu m_e u_y.
\end{align*}
In the frequency domain, this gives 
\begin{align*}
 \epsilon_0 i\omega E_x=-e N_e u_x,\\
 \epsilon_0 i\omega E_y+\partial_x H=-e N_e u_y,\\
 \mu_0 i\omega H +\partial_x E_y=0,\\
 m_e i\omega u_x=eE_x+eu_y B_0-\nu m_e u_x,\\
  m_e i\omega u_y=eE_y-eu_x B_0-\nu m_e u_y.
\end{align*}
Let us rewrite this as a system for $E_x,\; E_y$, introducing as well $\tilde{\omega}=\omega-i\nu$.

First, 
\begin{align*}
 u_x=\frac{e E_x}{m_ei\tilde{\omega}}-\frac{\omega_c}{i\tilde{\omega}}u_y,
\end{align*}
where $\omega_c=\frac{|e|B_0}{m_e}$. 

From this:
\begin{align*}
 u_y m_e i\tilde{\omega}\left(1-\frac{\omega_c^2}{\tilde{\omega}^2}\right)=&eE_y-\frac{e^2 B_0 E_x}{m_ei\tilde{\omega}}E_x\\
 & eE_y-i\frac{e\omega_c}{\tilde{\omega}} E_x.
\end{align*}

Then we find $u_x$ from this expression:
\begin{align*}
 u_x&=-i\frac{e E_x}{m_e \tilde{\omega}}-\frac{\omega_c}{i\tilde{\omega}}
 \left(\frac{e}{m_e i\tilde{\omega}\left(1-\frac{\omega_c^2}{\tilde{\omega}^2}\right)}E_y-
 \frac{e\omega_c}{\tilde{\omega}^2 m_e \left(1-\frac{\omega_c^2}{\tilde{\omega}^2}\right)}\right)\\
 &=-i\frac{e E_x}{m_e\tilde{\omega}}+\frac{\omega_c e}{(\tilde{\omega}^2-\omega^2_c)m_e}E_y-i\frac{\omega_c^2 e}{\tilde{\omega}(\tilde{\omega}^2-\omega^2_c)m_e}E_x.
\end{align*}

We insert this into the formula for $E_x$ to obtain
\begin{align*}
 i\omega \epsilon_0 E_x+eN_e 
 \left(-i\frac{e E_x}{m_e\tilde{\omega}}
 +\frac{\omega_c e}{(\tilde{\omega}^2-\omega^2_c)m_e}E_y-
 i\frac{\omega_c^2 e}{\tilde{\omega}(\tilde{\omega}^2-\omega^2_c)m_e}E_x\right)=0.
\end{align*}
It is not difficult to see that 
\begin{align*} 
E_x\left(1-\frac{\omega_p^2}{\tilde{\omega}\omega}-\frac{\omega_c^2\omega_p^2}{\tilde{\omega}{\omega}(\tilde{\omega}^2-\omega_c^2)}\right)
=\frac{i\omega_p^2\omega_c}{\omega(\tilde{\omega}^2-\omega_c^2)}E_y,
\end{align*}
or
\begin{align*}
 (1-\frac{\omega_p^2\tilde{\omega}}{\omega(\tilde{\omega}^2-\omega_c^2)})E_x=i\frac{\omega_p^2\omega_c}{\omega(\tilde{\omega}^2-\omega^2_c)}E_y.
\end{align*}

Similarly, we use the expressions for $E_y,\; H, \; u_y$ to obtain 
\begin{align*}
 \epsilon_0 i\omega E_y-\frac{\partial_{xx}E_y}{\mu_0i\omega}+
 eN_e\left(eE_y-i\frac{e\omega_c}{\tilde{\omega}} E_x\right)\left(m_e i\tilde{\omega}\left(1-\frac{\omega_c^2}{\tilde{\omega}^2}\right)\right)^{-1}=0,\\
 \partial_{xx} E_{y}+\frac{\omega^2}{c^2}E_y-
 \frac{e^2N_ei\omega \mu_0}{m_e i\tilde{\omega}\left(1-\frac{\omega_c^2}{\tilde{\omega}^2}\right)}E_y+i\frac{e^2 N_e\omega_c\mu_0 i\omega}{(\tilde{\omega}^2-\omega_c^2)m_e i}E_x=0.
\end{align*}
This gives 
\begin{align*}
  \partial_{xx} E_{y}+\frac{\omega^2}{c^2}\left(1-\frac{\omega_p^2\tilde{\omega}}{\omega (\tilde{\omega}^2-\omega_c^2)}\right)E_y+
  i\frac{\omega^2}{c^2}\frac{\omega_p^2\omega_c}{\omega(\tilde{\omega}^2-\omega^2_c)}E_x=0.
\end{align*}


Hence,

\begin{align*}
\left(1-\frac{\omega_p^2\tilde{\omega}}{\omega(\tilde{\omega}^2-\omega_c^2)}\right)E_x=i\frac{\omega_p^2\omega_c}{\omega(\tilde{\omega}^2-\omega_c^2)}E_y,\\
\partial_{xx} E_y+\frac{\omega^2}{c^2}\left(1-\frac{\omega_p^2\tilde{\omega}}{(\tilde{\omega}^2-\omega_c^2)\omega}\right)E_y=
-i\frac{\omega^2}{c^2}\frac{\omega_p^2 \omega_c}{\omega(\tilde{\omega}^2-\omega^2_c)}E_x.
\end{align*}

Now, to obtain the frequency domain solution, we should expand the expression into series of $\nu$ (as $\nu\rightarrow 0$):
\begin{align*}
 \frac{\omega_p^2\tilde{\omega}}{\omega(\tilde{\omega}^2-\omega_c^2)}&=
 \frac{\omega_p^2}{\omega^2-\omega_c^2}+i\nu\left(
 \frac{2\omega_p^2\omega}{(\omega^2-\omega^2_c)^2}-
 \frac{\omega_p^2}{\omega(\omega^2-\omega_c^2)}\right)+O(\nu^2)\\
 &=\frac{\omega_p^2}{\omega^2-\omega_c^2}+i\nu\omega_p^2\frac{\omega^2+\omega_c^2}{(\omega^2-\omega_c^2)^2}.
\end{align*}
Similarly,
\begin{align*}
 \frac{1}{(\tilde{\omega}^2-\omega^2_c)}=\frac{1}{\omega^2-\omega_c^2}+\frac{2i\omega\nu}{(\omega^2-\omega^2_c)^2}
\end{align*}

Hence,
\begin{align*}
\left(1-\frac{\omega_p^2}{\omega^2-\omega_c^2}-i\nu\omega_p^2\frac{\omega^2+\omega_c^2}{(\omega^2-\omega_c^2)^2}\right)E_x=
i\left(\frac{\omega_p^2\omega_c}{\omega(\omega^2-\omega_c^2)}+\frac{2i\omega\nu}{(\omega^2-\omega^2_c)^2}\right)E_y,\\
\partial_{xx} E_y+\frac{\omega^2}{c^2}
\left(1-\frac{\omega_p^2}{\omega^2-\omega_c^2}-i\nu\omega_p^2\frac{\omega^2+\omega_c^2}{(\omega^2-\omega_c^2)^2}\right)E_y=
-i\frac{\omega^2}{c^2}\left(\frac{\omega_p^2\omega_c}{\omega(\omega^2-\omega_c^2)}+\frac{2i\omega\nu}{(\omega^2-\omega^2_c)^2}\right)E_x.
\end{align*}

Importantly, for the limiting absorption principle, the 'off-diagonal' terms ($\frac{2i\omega\nu}{(\omega^2-\omega^2_c)^2}$) are neglected.



NB: in L-M. article the signs are slightly different, because $\partial_t \rightarrow -i\omega$, hence probably the sign of $\nu$ differs from our implementation (by complex conjugation)...
Let also $\omega=c=1$. 

%In this case the connection between the frequency domain and the time domain is given by 
%\begin{align*}
% \nu_{f}=\omega_p^2\frac{\omega^2+\omega_c^2}{(\omega^2-\omega_c^2)^2}\nu.
%\end{align*}
If $\omega_c=0$, $\nu_f=\omega_p^2\nu$.




%Also,
%\begin{align*}
%\omega_p^2\frac{\omega^2+\omega_c^2}{(\omega^2-\omega_c^2)^2}\gg \frac{2\omega}{(\omega^2-\omega^2_c)^2}
%\end{align*}
%iff
%\begin{align*}
% \omega_p^2(\omega^2+\omega_c^2)\gg 2\omega.
%\end{align*}

%If 
%\begin{align*}
% \omega_p^2\omega_c^2\gg 2\omega,
%\end{align*}
%or
%\begin{align*}
% \omega_p^2\omega\gg 1.
%\end{align*}
%I.e. for example in the case of large $\omega_p$ and fixed but sufficiently large $\omega$. 


%Or we can demand that $\frac{2\omega\nu}{(\omega^2-\omega^2_c)^2}=O(\nu^2)$, which is the case if 
%$\frac{2\omega}{(\omega^2-\omega^2_c)^2}=O(\nu)$).

%In these cases the connection between the frequency domain and the time domain is given by 
%\begin{align*}
% \nu_{f}=\omega_p^2\frac{\omega^2+\omega_c^2}{(\omega^2-\omega_c^2)^2}\nu.
%\end{align*}



%I.e., roughly speaking, for $\nu_f=\operatorname{const}$, 
%we can choose $\nu$ in time domain (remembering that $i\omega\rightarrow \partial_t$)
%\begin{align*}
% \nu=\frac{(\omega^2-\omega_c^2)^2}{\omega_p^2(\omega^2+\omega_c^2)}\nu_f
%\end{align*}
%(? would this imply in time domain we should choose $\nu$ as $\frac{T^2}{2}\nu_f$?...)


\subsection{Experiments}
Let us conduct several numerical experiments, with the normalization chosen as $\epsilon_0=\mu_0=1$, $\omega=c=1$.

Also, we set $m_e=1$ and $e=-1$. From this it follows that $w_c=-B_0$ and $w_p^2=N_e$. 

We conduct the following numerical experiments:
\begin{itemize}
 \item case $N_e=\operatorname{const}$
 \item case $N_e\neq \operatorname{const}$, no resonance
 \item case $N_e\neq \operatorname{const}$, resonance
\end{itemize}

\subsubsection{Validity of  the Implementation}



\subsubsection{}




\subsubsection{Constant Electron Density}
We choose $N_e=11.0$, $w_c=0$. This corresponds to the frequency domain choice $\alpha(x)=-10$, $\delta(x)=0$. 
The discretization 
\begin{align*}
\end{align*}



\subsubsection{Non-constant Electron Density: case without resonance}
The electron density $N_e$:
\begin{align*}
N_e=0,\; x\leq -10,\\
N_e=1/9*x-1/9;
\end{align*}


\subsbusection{Non-constant Electron Density: case when $N_e(x)=0$ at one of the ends of the interval}

\subsubsection{Non-constant Electron Density: resonance case}
We choose $\omega_c:=\sqrt{0.5}$.

Also, 
\begin{align*}
\alpha(x)=1,\; x\leq -10,\\
\alpha(x)=-\frac{x}{10}, \; x>-10,\; x\leq 5,\\
\alpha(x)=-0.5, x>5.
\end{align*}
Clearly, $\delta(x)=\frac{\alpha(x)-1}{\sqrt{0.5}}$.

The electron density $N_e$:
\begin{align*}
 N_e=0,\; x\leq -10,\\
 N_e=0.5(1+0.1x),\;  \; x>-10,\; x\leq 5,\\
 N_e=\frac{3}{4},\; x>5.
\end{align*}






\begin{thebibliography}{99}
\bibitem{stable_yee_plasma_current} F. da Silva, M. Campos Pinto, B. Despres, S. Heuraux, Stable Coupling of the Yee Scheme with a Linear Current Model,
2014
\end{thebibliography}

\end{document}
