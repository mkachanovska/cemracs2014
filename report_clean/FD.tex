\section{Frequency domain study}
In the frequency domain, the velocity can be eliminated and it yields a simpler system under the form
of  Maxwell equations with the cold plasma dielectric tensor \cite{Stix,Despres_2014}. One obtains the equations
\bealn
%\label{eq:main_frequency_domain_1}
\operatorname{curl}\operatorname{curl}\hat{\mathbf{E}}-
\epsilon(\omega)\hat{\mathbf{E}}=0,\\
\epsilon(\omega)=\left(
\begin{matrix}
 \tilde{\alpha} & i\tilde{\delta} \\
 -i\tilde{\delta}  & \tilde{\alpha}
\end{matrix}
\right),\\
\tilde{\alpha}(\omega,x)=\frac{\omega^2}{c^2}\left(1-\frac{\tilde{\omega}\omega_p^2}{\omega(\tilde{\omega}^2-\omega_c^2)}\right),\qquad 
\tilde{\delta}(\omega)=\frac{\omega_c\omega_p^2}{\omega(\tilde{\omega}^2-\omega_c^2)},
\eealn
where the frequency 
$\tilde{\omega}=\omega+i\nu$ is shifted in the complex plane,
the cyclotron frequency is 
$ \omega_c={\frac{eB_0}{m_e}}$ and the plasma frequency is $ \omega_p^2=\frac{e^2 N_e}{\epsilon_0 m_e}$,\textcolor{red}{and $\epsilon(\omega)$ is the dielectric tensor of the cold plasma approximation.}
The series expansion as $\nu\rightarrow 0$ gives at leading orders
\bealn
 \tilde{\alpha}(\omega,x)=\alpha(\omega,x)+i\nu\frac{\omega_p^2(\omega^2+\omega_c^2)}{(\omega^2-\omega_c^2)^2}\frac{\omega^2}{c^2},\qquad \alpha(\omega)=\frac{\omega^2}{c^2}\left(1-\frac{\omega_p^2}{\omega^2-\omega_c^2}\right),\\
 \tilde{\delta}(\omega)=\delta(\omega)-\frac{2i\omega^3\nu}{c^2(\omega^2-\omega_c^2)^2},\qquad \delta(\omega)=\frac{\omega\omega_c\omega_p^2}{c^2(\omega^2-\omega_c^2)}.
\eealn
We finally obtain a simpler equation \cite{Despres_2014} 
%\ben
% \epsilon_{\nu}(\omega)\approx \epsilon_0+i\nu Id,\; \nu\rightarrow 0.
%\een
%Thus, in this work we concentrate on a model
\begin{align}
\label{eq:main_frequency_domain}
\operatorname{curl}\operatorname{curl}\hat{\mathbf{E}}-\frac{\omega^2}{c^2}
\left(\epsilon_0(\omega)+\nu Id\right)\hat{\mathbf{E}}=0,\\
\label{eq:epsilon_0}
\epsilon_0(\omega)=\left(
\begin{matrix}
 \alpha & i\delta \\
 -i\delta & \alpha 
\end{matrix}
\right).
\end{align}
 In this model problem, the coefficients  $\alpha(\omega,x)$ and $\delta(\omega)$ are sufficiently smooth, i.e. bounded and continuous in  
$\left[-L,\; \mathbb{R}\right)$.



%%%%%%%%%%%%%%%%%%%%%% 
\subsection{1D case}
%%%%%%%%%%%%%%%%%%%%%% 
\label{sec:wellposedness}

In order to reduce problem \eqref{eq:main_frequency_domain} to one dimension, perform a Fourier transform in the $y$ variable, 
denoting by $\theta$ the corresponding Fourier variable. 
After introducing $\Omega=(-L,\; H)\subset \mathbb R$ and defining the function space of the problem  $\mathbf{V}=L^{2}(\Omega)\times H^{1}(\Omega)$, 
equipped with the norm
\ben
 \|\mathbf{v}\|_{\mathbf{V}}^2= \|v_1\|_{L^{2}(\Omega)}^2+\|v_2\|_{H^{1}(\Omega)}^2,
\een
the resulting one-dimensional system can be rewritten in the following variational form:
\begin{align}
\label{vf1dcase}
\begin{array}{l}
\displaystyle \int_{-L}^H (E_y' -\imath\theta E_x)\overline{(\tilde E_y' -\imath \theta \tilde E_x)} - \int_{-L}^H (\eps_0 +\imath\nu Id) \E \cdot \overline{\tilde \E}
%\\ \displaystyle 
 - \imath \lambda E_y (-L)\overline{ \tilde E_y (-L)} = -g_{inc} (-L) \overline{( \tilde E_y(-L) )},
\end{array}\\
\nonumber
\text{ for all } \tilde{\mathbf{E}}=(\tilde E_x,\tilde E_y)\in \mathbf{V}.
\end{align}
Recall that here $\lambda\geq 0$. 
%=\omega\geq 0$. 
Let us remark that in this and further sections, where it is not ambiguous, we will use the notation $E_{x,y}$ instead of $\hat{E}_{x,y}$ for convenience.

The above can be reformulated as 
\be
a\left(\mathbf{u},\mathbf{v}\right)=l(\mathbf{v}), \; \text{ for all }\mathbf{v}\in \mathbf{V},
\ee
with a bilinear form $a$ and a linear form $l$:
\be
a(\ubf,\vbf) = a_1 (\ubf,\vbf) +\imath a_2(\ubf,\vbf)\  \text{ and } \  l(\vbf) = -g_{inc} (-L) \overline{(v_2(-L) )} 
\ee
where $a_1= a_1^*$ and $a_2=a_2^*$ are hermitian
\be
\left\{\begin{array}{l}
	a_1(\ubf,\vbf) = \int_{-L}^H (u_2' -\imath\theta u_1)\overline{(v_2' -\imath \theta v_1)} - \int_{-L}^H \eps_0 \ubf\cdot \overline{\vbf}, 
	\\ a_2(\ubf,\vbf) = -\nu \int_{-L}^H  \ubf\cdot \overline{\vbf} - \lambda u_2 (-L) \overline{v_2 (-L)} , 
\end{array}\right.
\ee
The unknown is $\ubf=(E_x,E_y)=(u_1,u_2)$ and $\vbf$ is a test function.

Let us denote the spectral radius of $\eps_0$ by $\heps =  \|\rho(\eps_0)\|_{L^\infty}$.
%\end{df}

We now prove the following result.

\begin{lemma}
\label{lemma:well_posedness}
If $\heps<+\infty$, the bilinear form 
\ben
 a(\ubf,\vbf):  \mathbf{V}\times \mathbf{V}\rightarrow \mathbb{C}
\een
is continuous and coercive for all $\nu\neq 0$: for all $\ubf,\vbf\in \mathbf{V}$ it holds that
\bealn
\label{eq:bilinear_cont}
\left\{\begin{array}{l}
\Re\left(\mathrm{e}^{i\alpha_{\nu}}a(\ubf,\ubf)\right)\geq \frac{|\nu|}{\sqrt{(\heps+\theta^2+1)^2+\nu^2}}\left(\frac{1}{2}\|u_2'\|^2_{L^2}  + \| \ubf \|_{L^2}^2\right),\; 
\text{ for some $\alpha_{\nu}\in\left(-\frac{\pi}{2}, 0\right)\cup \left(0,\frac{\pi}{2}\right)$},\\
|a(\ubf,\vbf)|\leq C \|\ubf\|_{\mathbf{V}}\|\vbf\|_{\mathbf{V}},
\end{array}\right.
\eealn
where $C>0$ does not depend on $\nu$. The problem~\eqref{vf1dcase} is well-posed in $\mathbf{V}$.

\end{lemma}
%\textcolor{red}{!!!! redo coercivity computations !!!}
\begin{proof}
	The boundedness of $a$ is obvious using the continuous embedding in dimension
	one  $H_1(\Omega)\subset C^0(\overline \Omega)$. Let us focus on the proof of coercivity. 
	Without loss of generality let us assume that $\nu>0$. We denote $\heps =  \|\rho(\eps_0)\|_{L^\infty}$, the spectral radius of $\eps_0$ so that
	$\heps Id- \eps_0 $ is a non negative hermitian matrix.
	Therefore
	\be 
	a_1(\ubf,\ubf) + \heps\|\ubf\|^2_{L^2}= \|u_2' - \imath \theta u_1 \|^2_{L^2} + \left( (\heps Id - \eps_0 ) \ubf, \overline{\ubf} \right)  \geq \|u_2 ' - \imath \theta u_1 \|_{L^ 2}^ 2
	\geq \frac12 \|u_2 '  \|_{L^ 2}^ 2 -
	\theta ^2 \| u_1 \|_{L^ 2}^ 2.
	\ee
	Thus one can write
	$
	a_1(\ubf,\ubf)  \geq \frac{1}{2}\|u_2'\|^2_{L^2}-  (\heps  +  \theta^2) \| \ubf \|_{L^2}^2$.
	One also has that
	$
	a_2 (\ubf ,\ubf) \leq -\nu \| \ubf \|_{L^2}^2$. 
	Therefore
	\ben
	a_1(\ubf,\ubf)-\frac{\heps  +  \theta^2 + 1 }\nu a_2(\ubf,\ubf)\geq \frac{1}{2}\|u_2'\|^2_{L^2}  + \| \ubf \|_{L^2}^2,
	\een
	or, introducing $\alpha_{\nu}=\arccos\frac{1}{\sqrt{1+\left(\heps+\theta^2+1\right)^2\nu^{-2}}}$, this is equivalent to 
	\ben
	\Re\left(\mathrm{e}^{i\alpha_{\nu}}a(\ubf,\ubf)\right)\geq 
	\frac{1}{\sqrt{1+\left(\heps+\theta^2+1\right)^2\nu^{-2}}} \left(\frac{1}{2}\|u_2'\|^2_{L^2}  + \| \ubf \|_{L^2}^2\right)\\
	\geq \frac{\nu}{\sqrt{(\heps+\theta^2+1)^2+\nu^2}}\left(\frac{1}{2}\|u_2'\|^2_{L^2}  + \| \ubf \|_{L^2}^2\right).
	\een
	The problem \eqref{vf1dcase} is uniquely solvable thanks to Lax-Milgram theorem.
\end{proof}


\begin{remark} 
\label{remark:other}
The above proof is not optimal in the case when $\left|\alpha(x)\right|>c>0$ for $c>0$ on the whole interval $[-L,\; H]$, at least 
for the case $\theta=0$. In this case the problem (\ref{eq:var_form2}) is well-posed for $\nu=0$. More precisely, it can be written 
as a system of two equations, where the first equation (for $E_y$) is the variational formulation for the Helmholtz equation 
with the variable coefficient $k^2=(\alpha(x)-\frac{\delta^2}{\alpha(x)})$, and the second equation 
\begin{align*}
  \left(E_x,u\right)=-\left(\frac{i\delta}{\alpha(x)}E_y,u\right),\; \text{ for all } u\in L^{2}(\Omega), 
\end{align*}
uniquely defines $E_x\in L^{2}(\Omega)$. The well-posedness of the former problem, with additional assumptions on boundary conditions and smoothness of the coefficients, 
was demonstrated in \cite{LMIG_thesis}. Provided the solution $E_y\in H^{1}(\Omega)$, we can obtain $E_x$ from the second equation.

%%Let us consider the problem (\ref{eq:var_form2}) for $\nu=0,\; \theta=0$, which, after testing it 
%%with $(\tilde{E}_x,\; 0)$ and $(0,\; \tilde{E}_y)$ from $\mathbf{V}$, can be rewritten as, see also (\ref{eq:epsilon_0})
%%\begin{align}
%%\label{eq:full_var}
%%\begin{split}
%%\int_{-L}^H \left(\alpha E_x+i\delta E_y \right)_{1} \overline{\tilde E}_{x}&=0,\; \text{ for all }\tilde{E}_x\in L^{2}(\Omega), \;\\
%%\displaystyle \int_{-L}^H E_y'\tilde {E_y'} - \int_{-L}^H\left( -i\delta E_x+\alpha E_y \right)_{2}\overline{\tilde{E}}_{y}
%%  - \imath \lambda E_y (-L) \overline{\tilde E_y} (-L) &= -g_{inc} (-L) \overline{( \tilde E_y(-L) )},\\
%%  \text{ for all }  \tilde{E}_{y}\in H^{1}(\Omega).
%%  \end{split}
%%\end{align}
%%The first equation of the above can be rewritten as 
%%\ben
%% \left(E_x,\alpha \tilde{E}_x\right)=-\left(i\delta E_y,  \tilde{E}_x\right).
%%\een
%%If the multiplication operator $M_{\alpha}$ defined as $M_{\alpha}\psi=\frac{1}{\alpha}\psi$ is an isomorphism from $L^{2}([-L,\;H])$ to $L^{2}([-L,\;H])$ (this is true if e.g.
%%$\alpha \in C_{0}([-L,\;H])$ and $|\alpha(x)|>c>0$, for some $c>0$, on the whole interval), this equation is equivalent to 
%%\begin{align}
%%\label{eq:mult_eq}
%%  \left(E_x,u\right)=-\left(\frac{i\delta}{\alpha}E_y,u\right),\; \text{ for all } u\in L^{2}(\Omega). 
%%\end{align}

%%Choosing in the above $u=-i\delta \tilde{E}_y \in L^{2}(\Omega)$ and adding it to the second equation of (\ref{eq:full_var}), we obtain
%%\bealn
%% \displaystyle \int_{-L}^H E_y'\tilde {E_y'} - \int_{-L}^H (\alpha-\frac{\delta^2}{\alpha})E_y \overline{\tilde{E}}_{y}
%%  - \imath \lambda E_y (-L) \overline{\tilde E_y} (-L) &= -g_{inc} (-L) \overline{( \tilde E_y(-L) )},\\
%%  \text{ for all } \tilde{E}_{y}\in H^{1}(\Omega). \nonumber
%%\eealn
%%Thus we obtain the variational formulation for $E_y$, or the variational formulation for the Helmholtz equation. The well-posedness 
%%of this problem, with additional assumptions on boundary conditions and smoothness of the coefficients, 
%%had been demonstrated in \cite{LMIG_thesis}. Provided the solution $E_y\in H^{1}(\Omega)$, we can obtain $E_x$ from the equation (\ref{eq:mult_eq}).
\end{remark}

%\subsection{2D case}
%%%%%%%%%%%%%%%%%%%%%% 


%%%%%%%%%%%%%%%%%%%%%% 
%\textcolor{red}{!!!!!!!!!!!!!!!! TODO : deal with this part !!!!!!!!!!!}
%$curl$ ibp formula
%\be
%\int_\Omega \curl u \cdot \f = \int_\Omega u\ curl \f + \int_\Gamma u (\f \wedge \n)
%\ee
%\be
%\int_\Omega curl \E \cdot \overline{curl \tilde \E} - \int_\Omega \eps \E \cdot \overline{\tilde \E} + \int _\Gamma curl \E \overline{\left( \tilde \E\wedge \n \right)} d\sigma = 0
%\ee
%\be
%\begin{array}{l}
%\displaystyle \int_\Omega curl \E \cdot \overline{curl \tilde \E} - \int_\Omega (\eps_0+i\nu Id) \E \cdot \overline{\tilde \E} - \int _{\{x=-L\}} \imath \sqrt{\alpha(-L)}(\E\wedge \n) \overline{\left( \tilde \E\wedge \n \right)} d\sigma 
%\\ \displaystyle \phantom{ fffffffff}= \int_{\{x=-L\}} g_{inc}  \overline{\left( \tilde \E\wedge \n \right)} d\sigma
%\end{array}\ee
%\textcolor{red}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}


%%%%%%%%%%%%%%%%%%%%
\subsection{Discretization of the Frequency Domain Problem}
\label{sec:discr}
Testing the variational formulation (\ref{vf1dcase}) with $(\tilde E_x,0)$ and $(0,\; \tilde{E}_y)\in\mathbf{V}(\Omega)$ and using 
an explicit expression for the tensor of the dielectric permittivity (\ref{eq:epsilon_0}), we can rewrite it as a system of two equations
%\begin{align*}
%\begin{split}
%i\theta \displaystyle \int_{-L}^H (E_y' -\imath\theta E_x)\overline{\tilde E_x} - \int_{-L}^H \left((\epsilon_0 +\imath\nu \operatorname{Id}) \E\right)_{1} \overline{\tilde E}_{x}
%&=0,\\
%\displaystyle \int_{-L}^H (E_y' -\imath\theta E_x)\tilde {E_y'} - \int_{-L}^H\left( (\epsilon_0 +\imath\nu\operatorname{Id}) \E\right)_{2}\overline{\tilde{E}}_{y}
%  - \imath \lambda E_y (-L) \tilde E_y (-L) &= -g_{inc} (-L) \overline{( \tilde E_y(-L) )},\\
%  \text{ for all } \tilde E_x\in L^{2}(\Omega), \; \tilde{E}_{y}\in H^{1}(\Omega).
%  \end{split}
%\end{align*}
%Using the explicit expression for the dielectric permittivity tensor in the above, it yields: 

\begin{align}
\label{eq:var_form2}
\begin{split}
 i\theta \displaystyle \int_{-L}^H (E_y' -\imath\theta E_x)\overline{\tilde E_x} - 
 \int_{-L}^H \left((\alpha+i\nu)E_x+\imath\delta E_y\right)_{1} \overline{\tilde E}_{x}
&=0,\\
\int_{-L}^H (E_y' -\imath\theta E_x)\tilde {E_y'} -
\int_{-L}^H\left( -\imath \delta E_x+(\alpha+i\nu) E_y\right)_{2}\overline{\tilde{E}}_{y}
  - \imath \lambda E_y (-L) \tilde E_y (-L) &= -g_{inc} (-L) \overline{( \tilde E_y(-L) )},\\
 \text{ for all } \tilde E_x\in L^{2}(\Omega), \; \tilde{E}_{y}\in H^{1}(\Omega).
  \end{split}
\end{align}
Let us introduce two basis function spaces $V_{E_x}=\{\psi_{j}\}_{j=1}^{N_{1}}$ and $V_{E_{y}}=\{\phi_{i}\}_{i=1}^{N_{2}}$. 
%We look for the solution of the problem (\ref{eq:var_form2}) in the form:
We discretize problem (\ref{eq:var_form2}) as:
\ben
E_x=\sum\limits_{k=1}^{N_{1}}e_{xk}\psi_{k},\qquad E_{y}=\sum\limits_{k=1}^{N_{2}}e_{yk}\phi_{k}.
\een

% Substituting $\tilde{E}_{x}=\psi_{m}, \; m=1,\ldots,N_{1}$ and $\tilde{E}_{y}=0$ into the variational formulation (\ref{}), we obtain:
% \begin{align*}
% i\theta\sum\limits_{k=1}^{N_{2}}e_{2k}\int\limits_{-L}^{H}\phi'_{k}\bar{\psi}_{m}dx+\theta^2\sum\limits_{k=1}^{N_{1}}e_{1k}\int\limits_{-L}^{H}\psi_{k}\bar{\psi}_{m}dx\\
% -\sum\limits_{k=1}^{N_{1}}e_{1k}\int\limits_{-L}^{H}(\alpha(x)+i\nu)\psi_{k}\bar{\psi}_{m}dx-i\sum\limits_{1}^{N_{2}}e_{2k}\int\limits_{-L}^{H}\delta(x)\phi_{k}(x)\bar{\psi}_{m}dx=0.
% \end{align*}
% Similarly, for $\tilde{E}_{x}=0$ and $\tilde{E}_{y}=\phi_{\ell},\; \ell=1,\ldots, N_{2}$:
% \begin{align*}
% \sum\limits_{k=1}^{N_{2}}e_{2k}\int\limits_{-L}^{H}\phi'_{k}(x)\bar{\phi}'_{\ell}(x)dx-i\theta\sum\limits_{k=1}^{N_{1}}e_{1k}\int\limits_{-L}^{H}\psi_{k}(x)\bar{\phi}'_{\ell}(x)dx\\
% +i
% \sum\limits_{k=1}^{N_{1}}e_{1k}\int\limits_{-L}^{H}\delta(x)\psi_{k}\bar{\phi}_{m}dx-\sum\limits_{k=1}^{N_{2}}e_{2k}\int\limits_{-L}^{H}(\alpha(x)+i\nu)\phi_{k}\bar{\phi}_{m}dx\\
% -
% i\lambda\sum\limits_{k=1}^{N_{2}}e_{2k}\phi_{k}(-L)\bar{\phi}_{m}(-L)=-g_{inc}(x)\bar{\phi}_{m}(-L).
% \end{align*}
Introducing the notation
\bealn
\left(K^{\psi,\phi'}\right)_{mk}=\int\limits_{-L}^{H}\bar{\psi}_{m}\phi'_{k}dx,\qquad \left(M^{\psi}\right)_{mk}=\int\limits_{-L}^{H}\psi_{k}\bar{\psi}_{m}dx, \qquad 
\left(M^{\alpha,\psi}\right)_{mk}=\int\limits_{-L}^{H}(\alpha(x)+i\nu)\psi_{m}\bar{\psi}_{k}dx,\\
\left(M^{\delta,\psi,\phi}\right)_{mk}=\int\limits_{-L}^{H}\delta(x)\bar{\psi}_{m}\phi_{k}dx, \qquad 
K_{\ell k}=\int\limits_{-L}^{H}\phi'_{k}(x)\bar{\phi}'_{\ell}(x)dx,\qquad
\left(M^{\alpha,\phi}\right)_{\ell k}=\int\limits_{-L}^{H}(\alpha(x)+i\nu)\bar{\phi}_{\ell}\phi_{k}dx,\\
I_{km}^{\Gamma}=\bar{\phi}_{m}(-L)\phi_{k}(-L), \\
\boldsymbol{e}_{x}=\left(e_{11},\ldots,e_{1 N_{1}}\right)^{T},\; \boldsymbol{e}_{y}=\left(e_{21},\ldots,e_{2 N_{1}}\right)^{T},\\
\boldsymbol{0}_{n} \text{ is an $n$-dimensional zero column vector},
\eealn
we rewrite the system (\ref{eq:var_form2}) in an antisymmetric block form:
\ben
\left(\begin{matrix}
\theta^2 M^{\psi}-M^{\alpha,\psi} & i\theta K^{\psi,\phi'}-i M^{\delta,\psi,\phi} \\
-i\theta (K^{\psi,\phi'})^{*}+i (M^{\delta,\psi,\phi})^{*} & K-M^{\alpha,\phi}-i\lambda I^{\Gamma}
\end{matrix}\right)
\left(
\begin{matrix}
\boldsymbol{e}_x\\
\boldsymbol{e}_y
\end{matrix}
\right)=-g_{inc}(-L)
\left(
\begin{matrix}
\boldsymbol{0}_{N_{1}}\\
\bar{\phi}_{1}(-L)\\
\bar{\phi}_{2}(-L)\\
\vdots\\
\bar{\phi}_{N_{2}}(-L)
\end{matrix}
\right).
\een
This expression greatly simplifies when choosing $V_{E_x}=V_{E_{y}}=\left(\phi_{m}\right)_{m=1}^{N_{2}}$ and
in the case $\theta=0$. One obtains the matrix structure
\begin{align}
\label{eq:simple_system}
\left(\begin{matrix}
M^{\alpha,\phi} & i M^{\delta,\phi,\phi} \\
i (M^{\delta,\phi,\phi})^{*} & K-M^{\alpha,\phi}-i\lambda I^{\Gamma}
\end{matrix}\right)
\left(
\begin{matrix}
\boldsymbol{e}_x\\ 
\boldsymbol{e}_y
\end{matrix}
\right)=-g_{inc}(-L)
\left(
\begin{matrix}
\boldsymbol{0}_{N_{1}}\\
\bar{\phi}_{x}(-L)\\
\bar{\phi}_{y}(-L)\\
\vdots\\
\bar{\phi}_{N_{2}}(-L)
\end{matrix}
\right).
\end{align}
In this work we use the above formulation with the Lagrange $P_{1}$ basis elements. 
